from pwn import *
import random
import json
prime_p = 136062877477772021443963986821466822423928306636725705955189295265171531194630539497933022412421177627488716473227275120023271715397034546804175879349877168981582602251424924699340785448683074807806407936267383798949594772365085169340683942944085482956202789355681500477966677233789310292180313638378062381719
prime_q = 68031438738886010721981993410733411211964153318362852977594647632585765597315269748966511206210588813744358236613637560011635857698517273402087939674938584490791301125712462349670392724341537403903203968133691899474797386182542584670341971472042741478101394677840750238983338616894655146090156819189031190859
generator = 68695322546411990097618816719880607069395444393834268960741680054974511660271970026150039567236118658479679444015844573677880347686810169165388385685914903968147097279757787122753390447954112451193808647256026282821032909814441591222220915875289906762225085266354556177943238500761050758957943922408034634359
pubkey = 36991800195284720665844271720947930981390989677197504667186660329002236402308726349324091955441781822949964937615015455023644196915268032941399396215222246260792225979887225009692399584709504066456654354497353988045808198493705842231370889778472138080706702885925221219949367522908916161488494916365255595354
privkey = 5263045652030829720625950324476951638527389639800117394005805993739437950012420290717035157538691536436529232007292620246057638450401084844265538698975867001166137329826347797555219360650659593484333088610999481379136175469766869654931014059301411308265955434481886209963146697978603340536512636092802169975
r = random.randrange(prime_q-1)

for port in (2437,2438):
	conn = remote("localhost",port)
	challenge = json.loads(conn.readline())["c"]

	x = pow(generator,r,prime_p)
	y = (r + privkey*challenge) % prime_q

	proof = {'x' : x, 'y' : y }
	proof = json.dumps(proof)
	conn.sendline(proof)
	print(conn.recvuntil(b"}"))
	conn.close()
	sleep(23)
